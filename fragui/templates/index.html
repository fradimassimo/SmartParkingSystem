<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Smart Parking System</title>
    <link rel="icon" href="/static/LogoCarP.jpeg" type="image/jpeg">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap, Leaflet, Google Fonts, and additional styles -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="header-title">
            <span class="header-icon">&#x1F4CD;</span>
            <h1>Smart Parking Management System</h1>
        </div>
        <h2>Gestisci il parcheggio in modo intelligente e ottimizzato</h2>
    </header>

    <!-- Form per la selezione della zona -->
    <div class="container mt-4">
        <form action="{{ url_for('select_zone') }}" method="POST" id="zone-form">
            <div class="form-group">
                <label for="zone">Seleziona una zona:</label>
                <select name="zone" id="zone" class="form-control">
                    <option value="NORD">Trento Nord</option>
                    <option value="SUD">Trento Sud</option>
                    <option value="EST">Trento Est</option>
                    <option value="OVEST">Trento Ovest</option>
                    <option value="CENTRO">Centro Trento</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary btn-block">Seleziona Zona</button>
        </form>
    </div>

    <!-- Mappa -->
    <div id="map" style="height: 600px; margin-top: 30px;"></div>

    <!-- Link ai parcheggi -->
    <div class="parking-table mt-4">
        <h3 class="text-center">Available Parking Spaces</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Zone</th>
                    <th>Parking link</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Centro Trento</td>
                    <td><a href="{{ url_for('zone_selected', zone='CENTRO') }}">Select Parking Space - Centro</a></td>
                </tr>
                <tr>
                    <td>Trento Nord</td>
                    <td><a href="{{ url_for('zone_selected', zone='NORD') }}">Select Parking Space - Nord</a></td>
                </tr>
                <tr>
                    <td>Trento Ovest</td>
                    <td><a href="{{ url_for('zone_selected', zone='OVEST') }}">Select Parking Space - Ovest</a></td>
                </tr>
                <tr>
                    <td>Trento Sud</td>
                    <td><a href="{{ url_for('zone_selected', zone='SUD') }}">Select Parking Space - Sud</a></td>
                </tr>
                <tr>
                    <td>Trento Est</td>
                    <td><a href="{{ url_for('zone_selected', zone='EST') }}">Select Parking Space - Est</a></td>
                </tr>
            </tbody>
        </table>
    </div>

    <footer>
        <p>&copy; 2025 Smart Parking Management System</p>
    </footer>

    <script>
        function initMap() {
            // Coordinates of Trento (Centro)
            var lat = 46.0677;
            var lon = 11.1216;

            // Create the map centered on Trento
            var map = L.map('map').setView([lat, lon], 14.2);

            // Add tile layer to the map
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Define parking zones and links
            var parkingZones = {
                'Centro': { lat: 46.0677, lon: 11.1216, link: "{{ url_for('zone_selected', zone='CENTRO') }}" },
                'Nord': { lat: 46.0877, lon: 11.1216, link: "{{ url_for('zone_selected', zone='NORD') }}" },
                'Ovest': { lat: 46.0677, lon: 11.1000, link: "{{ url_for('zone_selected', zone='OVEST') }}" },
                'Sud': { lat: 46.0577, lon: 11.1216, link: "{{ url_for('zone_selected', zone='SUD') }}" },
                'Est': { lat: 46.0677, lon: 11.1416, link: "{{ url_for('zone_selected', zone='EST') }}" }
            };

            // Add circles for parking zones on the map
            for (var zone in parkingZones) {
                var zoneData = parkingZones[zone];
                var circle = L.circle([zoneData.lat, zoneData.lon], {
                    color: 'blue',
                    fillColor: '#3388ff',
                    fillOpacity: 0.5,
                    radius: 500
                }).addTo(map);

                // Add popup with zone name and link
                circle.bindPopup(
                    "<b>" + zone + "</b><br>" +
                    "<a href='" + zoneData.link + "' class='select-parking-link'>Select the Parking Space</a>"
                );
            }
        }

        window.onload = initMap;
    </script>
</body>
</html>

